\documentclass[oneside]{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{polski}
\usepackage{fancyhdr}
\usepackage{geometry}
\usepackage{multicol}
\usepackage{lastpage}
\usepackage{graphicx}
\usepackage{amsmath}

\geometry{margin=2cm}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{AGH WEAIiIB MTM}
\fancyhead[R]{\thepage\ /\ \pageref{LastPage}}
\fancyhead[C]{\today}

\begin{document}

% --- Tabela tytułowa ---
\begin{table}[h]
\centering
\begin{tabular}{lcr}
sem. V                  & \textbf{Elektroniczna Aparatura Medyczna} & Autorzy:  \\
Grupa I                 & Raport z Laboratorium                      & Krzysztof Domański (419630)\\
(pon. 13:15)            &                                           & Igor Głowacz (419808) \\ 
                        &                                           & \\
\hline
\end{tabular}
\end{table}

% ===============           TYTUL SPRAWOZDANIA
\vspace{-20pt}
\begin{center}
    {\LARGE \textbf{Wzmacniacze operacyjne w układach \\ LTI (Linear Time-Invariant)}}
\end{center}

% ===============           TRESC 
\begin{multicols}{2}

% ===============           ROZDZIAL 1 
\section{Wtórnik napięcia}

\subsection{Układ wtórnika napięciowego}
Testowany układ wtórnika napięciowego przedstawiono na poniższym schemacie. Układ zasilano napięciem symetrycznym $\pm 10V$ z dwóch połączonych szeregowo zasilaczy laboratoryjnych. Napięcia na wejście podawano w odniesieniu do masy (napięcia $0V$).

\begin{center}
    \includegraphics[width=0.95\linewidth]{lab_1-2/00_wtornik/PNGwtornik.png}
\end{center}

\subsection{Teoretyczne wzmocnienie układu}
\noindent Układ wtórnika napięciowego na wzmacniaczu operacyjnym wykorzystuje fakt że WO\footnote{W0 = wzmacniacz operacyjny} robi wszystko, aby trzymać oba wejścia na tym samym poziomie napięciowym ($V_+=V_-$),\footnote{zakładamy, że prąd wpływający do wejść wzmacniacza jest znikomy oraz offset napięciowy wzmacniacza jest do pominięcia} stąd:

\begin{align*}
& V_{+} = V_{in} = V_{-} \\ 
& V_{out} = V_{in} + I_{in}R_{fb} + V_{os} \simeq V_{in} \\
& \text{stąd: } \frac{V_{out}}{V_{in}} = 1
\end{align*}

\noindent Układ wtórnika napięciowego jest specjalną odmianą wzmacniacza nieodwracającego, gdzie rezystancja z wejścia odwracającego do masy dąży do nieskończoności, a rezystancja w sprzężeniu zwrotnym ma zazwyczaj mniejszą, skończoną wartość, stąd wzmocnienie jest około rózne jedności.

\newcolumn
\subsection{Charakterystyka przejściowa (DC)}
Pomiary dla zostały wykonane za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Użyto funkcji \textbf{Avg} w sekcji \textbf{Measure} oscyloskopu. Na wejście podawano napięcia z zakresu od -10V do 10V z krokiem 0.5V.

\begin{center}
    \includegraphics[width=0.95\linewidth]{lab_1-2/00_wtornik/DCwtornik.png}
\end{center}

\noindent Zakres napięć wyjściowych mieścił się w zakresie od $-9.08V$ do $9.67V$. Wyznaczony offset napięciowy dla podanego napięcia 0V wynosił  2mV. Jest to wartość mieszcząca się podanym w nocie katalogowej napięciu niezrównoważenia (Typ. 5mV oraz Max 15mV). 

\vspace{10pt}

\noindent Na charakterystyce przejściowej widoczny jest także efekt inwersji dla dwóch punktów pomiarowych (napięcia wejściowe -10V oraz -9.5V). Jest to zgodne z informacjami zawartymi w sekcji \textbf{APPLICATION HINTS} na stronie 10 noty katalogowej wzmacniacza TL082: \textbf{Exceeding the negative common-mode limit on either input will cause a reversal of the phase to the output and force the amplifier output to the corresponding high or low state}.


\newcolumn
\subsection{Charakterystyka częstotliwościowa (AC)}
Pomiary dla zostały wykonane za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Na wejście układu podano sygnał  sinusoidalny o amplitudzie $2V_{pp}$.

\begin{center}
    \includegraphics[width=0.95\linewidth]{lab_1-2/00_wtornik/ACwtornik.png}
\end{center}

Wzmocnienie utrzymuje się na poziomie około jedności ($\approx 0dB$) aż do częstotliwości granicznej> W częstotliwości granicznej ($\approx 2 MHz$) występuje lekki "peaking" co jest oznaką braku stabilności (margines fazy $\leq 45\deg $). W nocie katalogowej nie znaleziono informacji o tym czy TL082 jest unity-stable.



\subsection{Slew Rate}
Pomiar SR został wykonany za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Dane zapisano w postaci pliku \textit{.csv} na pendrive. Obliczenia wykonano na podstawie uzyskanych danych oraz porównano z dokumentacją.
\begin{center}
    \includegraphics[width=0.95\linewidth]{lab_1-2/00_wtornik/STEPwtornik.png}
\end{center}
\noindent Obliczenia SR na podstawie wyliczonych danych:
\begin{align*}
SR &= \frac{\Delta V}{\Delta t} = \frac{5V-0V}{270ns} \\ 
   &= \frac{5}{270}*10^9 \frac{V}{s} \\
   &\simeq 0.1851 * 10^8 \frac{V}{s} \\
   &= 18.51 * \frac{V}{10^-6*s} = 18.51 \frac{V}{\mu s}
\end{align*}

\noindent Układ odpowiedział zgodnie z założeniami na podany skok napięciowy. Na powyższym wykresie napięcia od czasu widoczny jest lekki undershoot/overshoot. Wyliczona wartość SR ($18.51 \frac{V}{\mu s}$) jest zbliżona do wartości typowej\footnote{SR - Slew Rate $V_{ss} = ±15V$, $T_{a} = 25°C$, Min: 8, Typ: 13 $V/\mu s$} ($13 \frac{V}{\mu s}$). Niedokładność lub ewentualne zawyżenie może wynikać z niedokładności pomiaru momentów, gdy napięcie uzyskało 10\% lub 90\% wartości napięcia końcowego (samo zbocze zawiera tylko 23 próbki).


\subsection{Wpływ zmiany napięcia zasilania na sygnał}
Pomiary zostały wykonane za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Dane zapisano w postaci dwóch plików \textit{.csv} na pendrive. Pomiary wykonano dla napięć zasilania $\pm10V$ oraz $\pm3.6V$.
\begin{center}
    \includegraphics[width=0.95\linewidth]{lab_1-2/00_wtornik/SUPPLYwtornik.png}
\end{center}





% ===============           ROZDZIAL 2 
\newpage
\section{Wzmacniacz nieodwracający}
\subsection{Układ wzmacniacza nieodwracającego}
Testowany układ wzmacniacza nieodwracającego przedstawiono na poniższym schemacie. Układ zasilano napięciem symetrycznym $\pm 10V$ z dwóch połączonych szeregowo zasilaczy laboratoryjnych. Napięcia na wejście podawano w odniesieniu do masy (napięcia $0V$).

\begin{center}
    \centering
    \includegraphics[width=0.95\linewidth]{lab_1-2/01_nodwracajacy/nodwr.png}
\end{center}
\subsection{Teoretyczne wzmocnienie układu}

Układ wzmacniacza nieodwracającego na wzmacniaczu operacyj-
nym wykorzystuje fakt że WO "próbuje trzymać" oba wejścia (odwracające i nieodwracające) na tym samym potencjale, stąd: $V_{in} = V_+ = V_-$. Dokładne obliczenia wzmocnienia napięciowego przedstawiono poniżej:
\vspace{-15pt}
\begin{align*}
    V_{in}&= V_+ = V_- \\
    V_{R_2} &= V_- = I_{R_2}*R_2 \quad \text{stąd:} \space I_{R_2} = \frac{V_{in}}{R_2} \\
    I_{R_1} &= I_{R_2} \\
    V_{R1} &= I_{R_1} * R_{1} \\
    V_{out} &= V_{R_2} +V_{R_1} = V_{in} + I_{R_1} * R_1 = V_{in} + \frac{V_{in}}{R_2} * R_1 \\
    &= V_{in} * (1+ \frac{R_1}{R_2}) \quad \text{stąd:}\\
    \frac{V_{out}}{V_{in}} &= 1+ \frac{R_1}{R_2} = 1 + \frac{10k}{100} = 101 \approx 100 [\frac{V}{V}] = 40 \text{dB}
    \\
\end{align*}

\vspace{-10pt}

\noindent Wzmocnienie napięciowe dane jest przez stosunek dwóch rezystorów w sumie z jednością. W powyższych obliczeniach nie wzięto pod uwagę skończonego pasma wzmocnienia dla WO. Na szczęście WO posiada parametr GBW (gain-bandwidth ratio), który łątwo pozwala nam oszacować pasmo dla danego ustawionego przez stosunek rezystorów wzmocnienia.
\vspace{-10pt}
\begin{align*}
    GBW &= Gain * BW = (1+ \frac{R_1}{R_2}) * BW = const \\
    BW &= \frac{GBW}{Gain} = \frac{4\text{MHz}}{101 \frac{V}{V}} \approx 40\text{kHz}
\end{align*}
\vspace{-10pt}
\noindent Występuje tak zwana wymiana pasma na wzmocnienie.


\subsection{Charakterystyka przejściowa (DC)}

Pomiary dla zostały wykonane za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Na wejście układu podano napięcia stałe co 100mV, a w interesującej nas części charakterystyki (od -100mV do 100mV) krok zmniejszono do 10mV.
\begin{center}
    \includegraphics[width=0.9\linewidth]{lab_1-2/01_nodwracajacy/DCnodwracajacy2.png}
\end{center}
\noindent Układ w praktyce działa tak jak zakładano w teoretycznych rozważaniach. Wzmocnienie układu wynosi $\approx 101$.

\subsection{Charakterystyka częstotliwościowa (AC)}

Pomiary dla zostały wykonane za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Na wejście ukłądu podano  przebieg sinusoidalny o amplitudzie $V = 60mV_{pp}$.

\begin{center}
    \includegraphics[width=0.9\linewidth]{lab_1-2/01_nodwracajacy/ACnodwracajacy.png}
\end{center}

Układ spełnia założenia teoretyczne - następuje wymiana wzmocnienia na pasmo według wzoru:
\vspace{-10pt}
\begin{align*}
    Gain*BW &= 101 [\frac{V}{V}] * 55[kHz] = 5 \space 555 \space kHz \approx 5.6 \space MHz \\
    GBW_{\text{datasheet}} &=  4 \space MHz
\end{align*}

\noindent GBW z noty katalogowej oraz iloraz wzmocnienia oraz pasma są zbliżone. Różnica może wynikać z niedokłądności podanego parametry GBW. W nocie katalogowej nie podane zostały wartości maksymalna ani minimalna, podano tylko wartość typową.

% ===============           ROZDZIAL 3 
\newpage
\section{Filtr dolnoprzepustowy (układ całkujący) oparty o wzmacniacz odwracający}
\subsection{Układ całkujący na wzmacniaczu operacyjnym}
\begin{center}
    \centering
    \includegraphics[width=0.95\linewidth]{lab_1-2/02_odwracajacy/odwr.png}
\end{center}

\noindent Układ wzmacniacza odwracającego na wzmacniaczu operacyj-
nym wykorzystuje fakt że WO na wejściu odwracającym trzyma punkt "masy pozornej", stąd: $V_{-} = 0V$. Dodatkowo w pętlę sprzężenia wpięty został kondensator który powoduje dolnoprzepustowe/całkujące zachowanie układu.

\subsection{Teoretyczne wzmocnienie układu}
\noindent Dokładne obliczenia wzmocnienia napięciowego oraz analiza lokacji biegunów przedstawiona została poniżej:

\begin{align*}
    I_{R_2} &= \frac{R_2}{V_{in}} \\
    I_f &= I_{R_2} \\
    I_f &= \frac{R_1||\frac{1}{sC_1}}{-V_{out}}= \frac{\frac{R_1}{1+ sR_1C_1}}{-V_{out}} \\
    \frac{R_2}{V_{in}} &= \frac{\frac{R_1}{1+ sR_1C_1}}{-V_{out}} \\
    \frac{V_{out}}{V_{in}} &= \frac{\frac{R_1}{1+ sR_1C_1}}{-R_2} = -\frac{R_1}{R_2}*(\frac{1}{1+ sR_1C_1}) \approx \\
    &\approx -\frac{R_1}{R_2} = -10 \frac{V}{V} \\= 20 \space \text{dB} \\
\end{align*}

\noindent Wzmocnienie układu w niskich częstotliwościach dany jest przez stosunek rezystorów $R_1$ oraz $R_2$ ze znakiem minus. Układ posiada także jeden biegun w $\omega_{LP} = - \frac{1}{R_1 C_1}$. Jest to wzmacniacz z filtrem dolnoprzepustowym o częstotliwości granicznej danej przez rezystor $R_1$ oraz kondensator $C_1$.

\subsection{Charakterystyka przejściowa (DC)}

Pomiary dla zostały wykonane za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Na wejście układu podano napięcia stałe co $500mV$, a w interesującej nas części charakterystyki (od -1V do 1V) krok zmniejszono do $100mV$. 

\begin{center}
    \centering
    \includegraphics[width=0.95\linewidth]{lab_1-2/02_odwracajacy/DCodwr.png}
\end{center}

Wejściowy offset napięciowy zmierzono na poziomie 80mV.

\subsection{Charakterystyka częstotliwościowa (AC)}
Pomiary dla zostały wykonane za pomocą oscyloskopu Rigol DS1102 oraz generatora Rigol DG812. Na wejście ukłądu podano  przebieg sinusoidalny o amplitudzie $V = 60mV_{pp}$.
\begin{center}
    \centering
    \includegraphics[width=0.9\linewidth]{lab_1-2/02_odwracajacy/odwr_AC.png}
\end{center}
\vspace{-10pt}
\noindent Podana charakterystyka zgadza się z założeniami teoretycznymi. Wzmocnienie układu w niskich częstotliwościach wynosi $20\text{dB} = 10$ co jest stosunkiem użytych rezystorów $R_1= 100 \text{kOhm oraz } R_2=10\text{kOhm}$. Układ działa jak filtr dolnoprzepustowy dla częstotliwości -3db: $f_g = 18\space \text{Hz}$. Teoretyczna częstotlwiość granicza została obliczona poniżej:
\vspace{-10pt}
\begin{align*}
    f_{gT} = \frac{1}{2 \pi R_1 C_1} = \frac{1}{2 \pi * 100\text{k} * 100\text{n}} \approx 15.91 \space \text{Hz} 
\end{align*}

\noindent Wszelakie rozbieżności pomiędzy wyznaczoną teoretyczną częstotliwością graniczną a pomiarami mogą wynikać z niedokładności użytych komponentów. Pomimo tego wartości zmierzone a teoretycznie nie odbiegają od siebie w znaczącym stopniu.


\subsection{Przykładowe przebiegi}

Na wejście układu podano 


% ===============           ROZDZIAL 3 

\end{multicols}

\end{document}